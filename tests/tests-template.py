#!/usr/bin/env python
# -*- coding: utf-8 -*-

import json
import time
import unittest

import paho.mqtt.client as mqtt

class TestBrokerConnection(unittest.TestCase): 

    def setUp(self):

        self.client = mqtt.Client("Modul test")
        self.client.on_connect = self.on_connect
        self.broker = "mosquitto"
        self.port = 1883
        self.has_connected = False
   
    def on_connect(self, client, userdata, flags, rc): 
        #connect function
        if rc==0:
            self.has_connected = True
   
    def test_connection(self): 
        #test to check connection to broker
        self.client.connect(self.broker, self.port)
        self.client.loop_start()

        time.sleep(2)

        self.client.loop_stop()
        self.assertTrue(self.has_connected)

class TestModul1(unittest.TestCase): 

    def setUp(self):

        self.client = mqtt.Client("Modul test")
        self.client.on_connect = self.on_connect
        self.broker = "mosquitto"
        self.port = 1883
        self.has_connected = False
   
    def on_connect(self, client, userdata, flags, rc): 
        #connect function
        if rc==0:
            self.has_connected = True

    def on_message_ok(self, client, userdata, message):

        message_content = message.payload.decode().replace("'", "\"")
        json_data = json.loads(message_content)
        image_name = json_data['imagename']
        image_data = json_data['imagedata']
        image_checksum = json_data['checksum']
        self.assertEqual('medium_aquamarine.png',image_name)
        self.assertEqual([[[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]], [[170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102], [170, 205, 102]]],image_data)
        self.assertEqual(2703,image_checksum)
    
    def on_message_invalid(self, client, userdata, message):

        message_content = message.payload.decode().replace("'", "\"")
        json_data = json.loads(message_content)
        image_name = json_data['imagename']
        image_data = json_data['imagedata']
        image_checksum = json_data['checksum']
        self.assertEqual('medium_slate_blue.png',image_name)
        self.assertEqual([[[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]]],image_data)
        self.assertEqual(2337,image_checksum)

    def test_status_ok(self):

        self.client.connect(self.broker, self.port)
        self.client.subscribe('image/status')
        self.client.on_message = self.on_message_ok

        message = {
            'imagename': 'medium_slate_blue.png',
            'imagestatus': 'ok'
        }

        self.client.loop_start()
        _ = self.client.publish('image/status', str(message))
        time.sleep(2)
        self.client.loop_stop()

    def test_status_invalid(self):

        self.client.connect(self.broker, self.port)
        self.client.subscribe('image/data')
        self.client.on_message = self.on_message_invalid

        message = {
            'imagename': 'medium_slate_blue.png',
            'imagestatus': 'invalid'
        }

        self.client.loop_start()
        _ = self.client.publish('image/status', str(message))
        time.sleep(2)
        self.client.loop_stop()

class TestModul2(unittest.TestCase): 

    def setUp(self):

        self.client = mqtt.Client("Modul test")
        self.client.on_connect = self.on_connect
        self.broker = "mosquitto"
        self.port = 1883
        self.has_connected = False
   
    def on_connect(self, client, userdata, flags, rc): 
        #connect function
        if rc==0:
            self.has_connected = True

    def on_message_ok(self, client, userdata, message):

        message_content = message.payload.decode().replace("'", "\"")
        json_data = json.loads(message_content)
        image_name = json_data['imagename']
        image_color = json_data['imagecolor']
        self.assertEqual('medium_slate_blue.png',image_name)
        self.assertEqual('mediumslateblue',image_color)
    
    def on_message_invalid(self, client, userdata, message):

        message_content = message.payload.decode().replace("'", "\"")
        json_data = json.loads(message_content)
        image_name = json_data['imagename']
        image_status = json_data['imagestatus']
        self.assertEqual('medium_slate_blue.png',image_name)
        self.assertEqual('invalid',image_status)

    def test_invalid_checksum(self):

        self.client.connect(self.broker, self.port)
        self.client.subscribe('image/status')
        self.client.on_message = self.on_message_invalid

        message = {'imagename': 'medium_slate_blue.png', 'imagedata': [[[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]]], 'checksum': 20}

        self.client.loop_start()
        _ = self.client.publish('image/data', str(message))
        time.sleep(2)
        self.client.loop_stop()

    def test_color_ok(self):

        self.client.connect(self.broker, self.port)
        self.client.subscribe('image/color')
        self.client.on_message = self.on_message_ok

        message = {'imagename': 'medium_slate_blue.png', 'imagedata': [[[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [244, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]], [[238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123], [238, 104, 123]]], 'checksum': 2337}

        self.client.loop_start()
        _ = self.client.publish('image/data', str(message))
        time.sleep(2)
        self.client.loop_stop()

class TestModul3(unittest.TestCase): 

    def setUp(self):

        self.client = mqtt.Client("Modul test")
        self.client.on_connect = self.on_connect
        self.broker = "mosquitto"
        self.port = 1883
        self.has_connected = False
   
    def on_connect(self, client, userdata, flags, rc): 
        #connect function
        if rc==0:
            self.has_connected = True

    def on_message_ok(self, client, userdata, message):

        message_content = message.payload.decode().replace("'", "\"")
        json_data = json.loads(message_content)
        image_name = json_data['imagename']
        image_status = json_data['imagestatus']
        self.assertEqual('medium_slate_blue.png',image_name)
        self.assertEqual('ok',image_status)
    
    def on_message_invalid(self, client, userdata, message):

        message_content = message.payload.decode().replace("'", "\"")
        json_data = json.loads(message_content)
        image_name = json_data['imagename']
        image_status = json_data['imagestatus']
        self.assertEqual('light_goldenrod_yellow',image_name)
        self.assertEqual('invalid',image_status)

    def test_color_invalid(self):

        self.client.connect(self.broker, self.port)
        self.client.subscribe('image/status')
        self.client.on_message = self.on_message_invalid

        message = {
            'imagename': 'medium_slate_blue.png',
            'imagecolor': 'mediumslateblue'
        }

        self.client.loop_start()
        _ = self.client.publish('image/color', str(message))
        time.sleep(2)
        self.client.loop_stop()

    def test_status_invalid(self):

        self.client.connect(self.broker, self.port)
        self.client.subscribe('image/status')
        self.client.on_message = self.on_message_invalid

        message = {
            'imagename': 'light_goldenrod_yellow.png',
            'imagecolor': 'mediumslateblue'
        }

        self.client.loop_start()
        _ = self.client.publish('image/color', str(message))
        time.sleep(2)
        self.client.loop_stop()

if __name__ == '__main__':
    unittest.main()